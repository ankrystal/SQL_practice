# 문제 13. 자동차 대여 기록 별 대여 금액 구하기

Q. CAR_RENTAL_COMPANY_CAR 테이블과 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블과 CAR_RENTAL_COMPANY_DISCOUNT_PLAN 테이블에서 자동차 종류가 '트럭'인 자동차의 대여 기록에 대해서 대여 기록 별로 대여 금액(컬럼명: FEE)을 구하여 대여 기록 ID와 대여 금액 리스트를 출력하는 SQL문을 작성해주세요. <br>
결과는 대여 금액을 기준으로 내림차순 정렬하고, 대여 금액이 같은 경우 대여 기록 ID를 기준으로 내림차순 정렬해주세요.

🔑 문제 풀이

### 오답코드
```mysql
SELECT HISTORY_ID
     , ROUND(CASE WHEN RENTAL_DATE < 7 THEN RENTAL_DATE * DAILY_FEE
                  WHEN RENTAL_DATE < 30 THEN RANTAL_DATE * DAILY_FEE * 0.95
                  WHEN RENTAL_DATE < 90 THEN RENTAL_DATE * DAILY_FEE * 0.92
                  ELSE RENTAL_DATE * DAILY_FEE * 0.85 END, 0) AS FEE
FROM( 
    SELECT HISTORY_ID
         , CAR_ID
         , (DATEDIFF(END_DATE, START_DATE) + 1) AS RENTAL_DATE
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE CAR_ID IN (
                     SELECT CAR_ID
                     FROM CAR_RENTAL_COMPANY_CAR
                     WHERE CAR_TYPE = '트럭')
    ) TA
LEFT JOIN CAR_RENTAL_COMPANY_CAR 
USING (CAR_ID)
ORDER BY FEE DESC, HISTORY_ID DESC
```

출처: [Programmers 문제 보기](https://school.programmers.co.kr/learn/courses/30/lessons/151141)
